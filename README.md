# MFA-START

ä¸€ä¸ªç”¨äºç®¡ç†å’ŒéªŒè¯ MFAï¼ˆå¤šå› ç´ è®¤è¯ï¼‰å¯†é’¥çš„å¼€æºå·¥å…·

## ğŸ“Œ é‡è¦è¯´æ˜

> **âš ï¸ æ³¨æ„ï¼š** å¯†ç å’Œæ•°æ®éƒ½å­˜å‚¨åœ¨éƒ¨ç½²æœåŠ¡å™¨ä¸Šçš„ H2 æ•°æ®åº“ä¸­ï¼Œæ‚¨å¯ä»¥éšæ—¶å…³é—­æœåŠ¡ã€‚å¦‚æœä»‹æ„æ•°æ®å­˜å‚¨ä½ç½®ï¼Œè¯·å‹¿ä½¿ç”¨æœ¬å·¥å…·ï¼Œè°¢è°¢ã€‚

### ä¸»è¦åŠŸèƒ½
- âœ… MFA å¯†é’¥éªŒè¯
- âœ… å¯†é’¥å­˜å‚¨ç®¡ç†
- âœ… å¯†é’¥å¯¼å‡ºåŠŸèƒ½
- âœ… Web ç•Œé¢ç®¡ç†

### ä½¿ç”¨è¯´æ˜
æ­¤ç¨‹åº**å®Œå…¨å…è´¹å¼€æº**ï¼Œä»…å¯ç”¨äº**æµ‹è¯•å’Œå­¦ä¹ **ç›®çš„ï¼Œ**ç¦æ­¢ç”¨äºä»»ä½•å•†ä¸šæˆ–éæ³•ç”¨é€”**ã€‚

## âš–ï¸ å…è´£å£°æ˜

> **è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹å…è´£æ¡æ¬¾ï¼š**

1. æœ¬ä»“åº“å‘å¸ƒçš„é¡¹ç›®ä¸­æ¶‰åŠçš„ä»»ä½•è„šæœ¬ï¼Œä»…ç”¨äºæµ‹è¯•å’Œå­¦ä¹ ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œä¸èƒ½ä¿è¯å…¶åˆæ³•æ€§ã€å‡†ç¡®æ€§ã€å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼Œè¯·æ ¹æ®æƒ…å†µè‡ªè¡Œåˆ¤æ–­ã€‚

2. æ‰€æœ‰ä½¿ç”¨è€…åœ¨ä½¿ç”¨é¡¹ç›®çš„ä»»ä½•éƒ¨åˆ†æ—¶ï¼Œéœ€å…ˆéµå®ˆæ³•å¾‹æ³•è§„ã€‚å¯¹äºä¸€åˆ‡ä½¿ç”¨ä¸å½“æ‰€é€ æˆçš„åæœï¼Œéœ€è‡ªè¡Œæ‰¿æ‹…ã€‚å¯¹ä»»ä½•è„šæœ¬é—®é¢˜æ¦‚ä¸è´Ÿè´£ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç”±ä»»ä½•è„šæœ¬é”™è¯¯å¯¼è‡´çš„ä»»ä½•æŸå¤±æˆ–æŸå®³ã€‚

3. å¦‚æœä»»ä½•å•ä½æˆ–ä¸ªäººè®¤ä¸ºè¯¥é¡¹ç›®å¯èƒ½æ¶‰å«Œä¾µçŠ¯å…¶æƒåˆ©ï¼Œåˆ™åº”åŠæ—¶é€šçŸ¥å¹¶æä¾›èº«ä»½è¯æ˜ã€æ‰€æœ‰æƒè¯æ˜ï¼Œæˆ‘ä»¬å°†åœ¨æ”¶åˆ°è®¤è¯æ–‡ä»¶ååˆ é™¤ç›¸å…³æ–‡ä»¶ã€‚

4. ä»»ä½•ä»¥ä»»ä½•æ–¹å¼æŸ¥çœ‹æ­¤é¡¹ç›®çš„äººæˆ–ç›´æ¥æˆ–é—´æ¥ä½¿ç”¨è¯¥é¡¹ç›®çš„ä»»ä½•è„šæœ¬çš„ä½¿ç”¨è€…éƒ½åº”ä»”ç»†é˜…è¯»æ­¤å£°æ˜ã€‚æœ¬äººä¿ç•™éšæ—¶æ›´æ”¹æˆ–è¡¥å……æ­¤å…è´£å£°æ˜çš„æƒåˆ©ã€‚ä¸€æ—¦ä½¿ç”¨å¹¶å¤åˆ¶äº†ä»»ä½•ç›¸å…³è„šæœ¬æˆ–æœ¬é¡¹ç›®çš„è§„åˆ™ï¼Œåˆ™è§†ä¸ºæ‚¨å·²æ¥å—æ­¤å…è´£å£°æ˜ã€‚

5. **æ‚¨å¿…é¡»åœ¨ä¸‹è½½åçš„ 24 å°æ—¶å†…ä»è®¡ç®—æœºæˆ–æ‰‹æœºä¸­å®Œå…¨åˆ é™¤ä»¥ä¸Šå†…å®¹ã€‚**

6. æ‚¨ä½¿ç”¨æˆ–è€…å¤åˆ¶äº†æœ¬ä»“åº“ä¸”æœ¬äººåˆ¶ä½œçš„ä»»ä½•è„šæœ¬ï¼Œåˆ™è§†ä¸ºå·²æ¥å—æ­¤å£°æ˜ï¼Œè¯·ä»”ç»†é˜…è¯»ã€‚

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**ï¼šLinux (æ¨è CentOS/Ubuntu)
- **Java ç‰ˆæœ¬**ï¼šJDK 8+ 
- **ç”¨æˆ·æƒé™**ï¼šéœ€è¦ root æƒé™
- **ç½‘ç»œè¦æ±‚**ï¼šèƒ½å¤Ÿè®¿é—® GitHub ä¸‹è½½èµ„æº

## ğŸ“¦ éƒ¨ç½²æ­¥éª¤

### 1. ç™»å½•æœåŠ¡å™¨
```bash
# åˆ‡æ¢åˆ° root ç”¨æˆ·
sudo su - root
```

### 2. åˆ›å»ºç›®å½•
```bash
# åˆ›å»ºåº”ç”¨ç›®å½•å¹¶è¿›å…¥
mkdir -p /root/mfa-start && cd /root/mfa-start
```

### 3. ä¸‹è½½éƒ¨ç½²è„šæœ¬
```bash
# ä¸‹è½½ç®¡ç†è„šæœ¬å¹¶èµ‹äºˆæ‰§è¡Œæƒé™
wget -O mfa-start.sh https://raw.githubusercontent.com/doubleDimple/shell-tools/master/mfa-start.sh && chmod +x mfa-start.sh
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### åŸºæœ¬å‘½ä»¤

#### 1ï¸âƒ£ å¯åŠ¨åº”ç”¨
```bash
./mfa-start.sh start
```
> é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨ä¸‹è½½æ‰€éœ€æ–‡ä»¶å¹¶ç”Ÿæˆç™»å½•å‡­æ®

#### 2ï¸âƒ£ åœæ­¢åº”ç”¨
```bash
./mfa-start.sh stop
```

#### 3ï¸âƒ£ é‡å¯åº”ç”¨
```bash
./mfa-start.sh restart
```

#### 4ï¸âƒ£ æŸ¥çœ‹çŠ¶æ€
```bash
./mfa-start.sh status
```

#### 5ï¸âƒ£ æ›´æ–°åº”ç”¨
```bash
./mfa-start.sh update
```
> æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä¿ç•™ç°æœ‰é…ç½®å’Œå‡­æ®

#### 7ï¸âƒ£ ä¿®æ”¹å‡­æ®

**åŒæ—¶ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç ï¼š**
```bash
./mfa-start.sh password admin mypassword123
```

**åªä¿®æ”¹ç”¨æˆ·åï¼ˆä¿æŒåŸå¯†ç ï¼‰ï¼š**
```bash
./mfa-start.sh password newadmin
```

**åªä¿®æ”¹å¯†ç ï¼ˆä¿æŒåŸç”¨æˆ·åï¼‰ï¼š**
```bash
./mfa-start.sh password "" newpassword456
```

## ğŸ“‹ å¿«é€Ÿå¼€å§‹ç¤ºä¾‹

```bash
# 1. åˆ›å»ºç›®å½•
mkdir -p /root/mfa-start && cd /root/mfa-start

# 2. ä¸‹è½½è„šæœ¬
wget -O mfa-start.sh https://raw.githubusercontent.com/doubleDimple/shell-tools/master/mfa-start.sh
chmod +x mfa-start.sh

# 3. å¯åŠ¨åº”ç”¨ï¼ˆé¦–æ¬¡ä¼šè‡ªåŠ¨ç”Ÿæˆå‡­æ®ï¼‰
./mfa-start.sh start

# 4. æŸ¥çœ‹ç”Ÿæˆçš„å‡­æ®
./mfa-start.sh password

# 5. è®¿é—® Web ç•Œé¢
# æµè§ˆå™¨è®¿é—®: http://æœåŠ¡å™¨IP:9999
# ä½¿ç”¨ä¸Šé¢æ˜¾ç¤ºçš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
/root/mfa-start/
â”œâ”€â”€ mfa-start.sh                 # ç®¡ç†è„šæœ¬
â”œâ”€â”€ mfa-start-release.jar        # ä¸»ç¨‹åº
â”œâ”€â”€ mfa-start.yml                # é…ç½®æ–‡ä»¶
â”œâ”€â”€ .mfa-password                # å¯†ç æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ data/                        # æ•°æ®ç›®å½•
    â””â”€â”€ mfa.mv.db               # H2 æ•°æ®åº“æ–‡ä»¶
```

## ğŸ” å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç **ï¼šé¦–æ¬¡å¯åŠ¨åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤ç”Ÿæˆçš„å¯†ç 
2. **é™åˆ¶è®¿é—®**ï¼šå»ºè®®é…ç½®é˜²ç«å¢™ï¼Œä»…å…è®¸å¯ä¿¡ IP è®¿é—® 9999 ç«¯å£
3. **å®šæœŸå¤‡ä»½**ï¼šé‡è¦æ•°æ®è¯·å®šæœŸå¤‡ä»½ `data` ç›®å½•
4. **HTTPS è®¿é—®**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®é…ç½®åå‘ä»£ç†å¯ç”¨ HTTPS

## â“ å¸¸è§é—®é¢˜

### Q: å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ
A: å¯ä»¥é€šè¿‡ `./mfa-start.sh password` æŸ¥çœ‹å½“å‰å¯†ç ï¼Œæˆ–ä½¿ç”¨ `./mfa-start.sh password "" æ–°å¯†ç ` é‡ç½®å¯†ç ã€‚

### Q: å¦‚ä½•ä¿®æ”¹é»˜è®¤ç«¯å£ï¼Ÿ
A: ç¼–è¾‘ `mfa-start.yml` æ–‡ä»¶ï¼Œä¿®æ”¹ `server.port` é…ç½®é¡¹ï¼Œç„¶åé‡å¯åº”ç”¨ã€‚

### Q: æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ
A: æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ `data` ç›®å½•ä¸‹çš„ H2 æ•°æ®åº“æ–‡ä»¶ä¸­ã€‚

### Q: å¦‚ä½•å®Œå…¨å¸è½½ï¼Ÿ
A: åœæ­¢æœåŠ¡åï¼Œåˆ é™¤æ•´ä¸ª `/root/mfa-start` ç›®å½•å³å¯ã€‚

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨å¼€æºè®¸å¯ï¼Œä»…ä¾›å­¦ä¹ å’Œæµ‹è¯•ä½¿ç”¨ï¼Œç¦æ­¢å•†ä¸šç”¨é€”ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·åœ¨ GitHub ä¸Šæäº¤ Issueã€‚
